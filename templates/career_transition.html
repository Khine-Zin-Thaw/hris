{% extends "base.html" %}

{% block content %}
<div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4">
        <span class="text-muted fw-light">Career Management /</span> Career Transition
    </h4>

    <form method="POST" action="{{ url_for('update_career', emp_id=employee.emp_id) }}">
        <!-- Employee Name -->
        <div class="mb-3">
            <label for="emp_name" class="form-label">Employee Name</label>
            <input type="text" id="emp_name" class="form-control" value="{{ employee.emp_name }}" readonly>
        </div>

        <!-- Transition Type Selection -->
        <div class="mb-3">
            <label for="career_status" class="form-label">Career Transition Type</label>
            <select id="career_status" name="career_status" class="form-control" required>
                <option value="Promotion">Promotion</option>
                <option value="Demotion">Demotion</option>
                <option value="Transfer">Transfer</option>
                <option value="Termination">Termination</option>
            </select>
        </div>

        <!-- Position Selection (Shown if Promotion/Demotion) -->
        <div id="position_section" class="mb-3" style="display: none;">
            <label for="position" class="form-label">New Position</label>
            <select id="position" name="position" class="form-control">
                {% for position in positions %}
                    <option value="{{ position.pos_id }}">{{ position.position_name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Department Selection (Shown if Transfer) -->
        <div id="department_section" class="mb-3" style="display: none;">
            <label for="department" class="form-label">New Department</label>
            <select id="department" name="department" class="form-control">
                {% for department in departments %}
                    <option value="{{ department.dept_id }}">{{ department.name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Team Selection (Shown if Transfer) -->
        <div id="team_section" class="mb-3" style="display: none;">
            <label for="team" class="form-label">New Team</label>
            <select id="team" name="team" class="form-control">
                <option value="">None</option>
                {% for team in teams %}
                    <option value="{{ team.team_id }}">{{ team.team_name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Basic Salary (Shown if Promotion/Demotion) -->
        <div id="salary_section" class="mb-3" style="display: none;">
            <label for="basic_salary" class="form-label">New Basic Salary</label>
            <input type="number" id="basic_salary" name="basic_salary" class="form-control" placeholder="Enter new basic salary">
        </div>

        <!-- Effective Date -->
        <div class="mb-3">
            <label for="effective_date" class="form-label">Effective Date</label>
            <input type="date" id="effective_date" name="effective_date" class="form-control" required>
        </div>

        <!-- Termination Date (Shown if Termination is selected) -->
        <div id="termination_section" class="mb-3" style="display: none;">
            <label for="termination_date" class="form-label">Termination Date</label>
            <input type="date" id="termination_date" name="termination_date" class="form-control">
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary">Submit Transition</button>
        <a href="{{ url_for('employee_details', emp_id=employee.emp_id) }}" class="btn btn-secondary">Cancel</a>
    </form>
</div>

<!-- JavaScript to show/hide sections based on transition type -->
<script>
    document.getElementById('career_status').addEventListener('change', function() {
        let status = this.value;

        // Hide all sections by default
        document.getElementById('position_section').style.display = 'none';
        document.getElementById('department_section').style.display = 'none';
        document.getElementById('team_section').style.display = 'none';
        document.getElementById('salary_section').style.display = 'none';
        document.getElementById('termination_section').style.display = 'none';

        if (status === 'Promotion' || status === 'Demotion') {
            document.getElementById('position_section').style.display = 'block';
            document.getElementById('salary_section').style.display = 'block';
        } else if (status === 'Transfer') {
            document.getElementById('department_section').style.display = 'block';
            document.getElementById('team_section').style.display = 'block';
        } else if (status === 'Termination') {
            document.getElementById('termination_section').style.display = 'block';
        }
    });
</script>
{% endblock %}
